from langchain.schema import HumanMessage, SystemMessage
from langchain.chat_models.gigachat import GigaChat
import telebot
from telebot import types

# –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ —Å–µ—Ä–≤–∏—Å–µ GigaChat
chat = GigaChat(credentials='ZWNhNjg5MDEtOGIxYS00Nzg1LWFiOTAtMjQ4ZjhmYjViZGIzOjZkNjk3ZWEyLTkwYTgtNDNmNC04YTIzLTMwODljY2QyZDA2OQ==', verify_ssl_certs=False)
bot = telebot.TeleBot('6837296858:AAFSVSodG1VsO46BCA3x4fcQLBj1YUl8Qas')

# messages = [
#     SystemMessage(
#         content="–¢—ã —ç–º–ø–∞—Ç–∏—á–Ω—ã–π –±–æ—Ç-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–≥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Ä–µ—à–∏—Ç—å –µ–≥–æ –ø—Ä–æ–±–ª–µ–º—ã."
#     )
# ]

# messages = [
#     SystemMessage(
#         content="–¢—ã –±–æ—Ç –∏—â—É—â–∏–π –æ—Ç–≤–µ—Ç—ã –≤ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω–æ-–ø—Ä–∞–≤–æ–≤—ã—Ö –∞–∫—Ç–∞—Ö –†–æ—Å—Å–∏–π—Å–∫–æ–π –§–µ–¥–µ—Ä–∞—Ü–∏–∏"
#     )
# ]

# messages = [
#     SystemMessage(
#         content="–¢—ã —Ä–∞–±–æ—Ç–∞–µ—à—å –≤ –æ—Ç–¥–µ–ª–µ –∑–∞–∫—É–ø–æ–∫ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏ –∏—â–µ—à—å –æ—Ç–≤–µ—Ç—ã –≤ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω–æ-–ø—Ä–∞–≤–æ–≤—ã—Ö –∞–∫—Ç–∞—Ö –†–æ—Å—Å–∏–π—Å–∫–æ–π –§–µ–¥–µ—Ä–∞—Ü–∏–∏"
#     )
# ]

# messages = [
#     SystemMessage(
#         content="–¢—ã —Ä–∞–±–æ—Ç–∞–µ—à—å –≤ –æ—Ç–¥–µ–ª–µ –∑–∞–∫—É–ø–æ–∫ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏ –∏—â–µ—à—å –æ—Ç–≤–µ—Ç—ã –≤ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω–æ-–ø—Ä–∞–≤–æ–≤—ã—Ö –∞–∫—Ç–∞—Ö –†–æ—Å—Å–∏–π—Å–∫–æ–π –§–µ–¥–µ—Ä–∞—Ü–∏–∏"
#     )
# ]

# messages = [
#     SystemMessage(
#         content="–¢—ã —Ä–∞–±–æ—Ç–∞–µ—à—å –≤ –æ—Ç–¥–µ–ª–µ –∑–∞–∫—É–ø–æ–∫ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –†–æ—Å–∞—Ç–æ–º –∏ –∏—â–µ—à—å –æ—Ç–≤–µ—Ç—ã –≤ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω–æ-–ø—Ä–∞–≤–æ–≤—ã—Ö –∞–∫—Ç–∞—Ö –†–æ—Å–∞—Ç–æ–º–∞ –∏ –ï–û–°–ó"
#     )
# ]

# messages = [
#     SystemMessage(
#         content="–¢—ã –±–æ—Ç –∏—â—É—â–∏–π –æ—Ç–≤–µ—Ç—ã –¥–ª—è –æ—Ç–¥–µ–ª–∞ –∑–∞–∫—É–ø–æ–∫ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –†–æ—Å–∞—Ç–æ–º —Å–æ–≥–ª–∞—Å–Ω–æ –ï–î–ò–ù–û–ú–£ –û–¢–†–ê–°–õ–ï–í–û–ú–£ –°–¢–ê–ù–î–ê–†–¢–£ –ó–ê–ö–£–ü–û–ö (–ü–û–õ–û–ñ–ï–ù–ò–ï –û –ó–ê–ö–£–ü–ö–ï) –ì–û–°–£–î–ê–†–°–¢–í–ï–ù–ù–û–ô –ö–û–†–ü–û–†–ê–¶–ò–ò –ü–û –ê–¢–û–ú–ù–û–ô –≠–ù–ï–†–ì–ò–ò ¬´–†–û–°–ê–¢–û–ú¬ª –∏ –≤ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω–æ-–ø—Ä–∞–≤–æ–≤—ã—Ö –∞–∫—Ç–∞—Ö –†–æ—Å—Å–∏–π—Å–∫–æ–π –§–µ–¥–µ—Ä–∞—Ü–∏–∏ –∏ –ø–∏—à–µ—à—å –∞–ª–≥–æ—Ä–∏—Ç–º –∏ —Å—Å—ã–ª–∫–∏ –Ω–∞ –∑–∞–∫–æ–Ω—ã"
#     )
# ]

messages = [
    SystemMessage(
        content="–¢—ã –±–æ—Ç –∏—â—É—â–∏–π –æ—Ç–≤–µ—Ç—ã –¥–ª—è –æ—Ç–¥–µ–ª–∞ –∑–∞–∫—É–ø–æ–∫ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –†–æ—Å–∞—Ç–æ–º —Å—Å—ã–ª–∞—è—Å—å –Ω–∞ –ï–¥–∏–Ω—ã–π –û—Ç—Ä–∞—Å–ª–µ–≤–æ–π –°—Ç–∞–Ω–¥–∞—Ä—Ç –ó–∑–∞–∫—É–ø–æ–∫ (–ü–æ–ª–æ–∂–µ–Ω–∏–µ –æ –∑–∞–∫—É–ø–∫–µ) –ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–π –ö–æ—Ä–ø–æ—Ä–∞—Ü–∏–∏ –ü–æ –ê—Ç–æ–º–Ω–æ–π –≠–Ω–µ—Ä–≥–∏–∏ ¬´–†–û–°–ê–¢–û–ú¬ª (–ï–û–°–ó) –∏ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω–æ-–ø—Ä–∞–≤–æ–≤—ã–µ –∞–∫—Ç–∞—ã –†–æ—Å—Å–∏–π—Å–∫–æ–π –§–µ–¥–µ—Ä–∞—Ü–∏–∏ –∏ –ø–∏—à–µ—à—å –∞–ª–≥–æ—Ä–∏—Ç"
    )
]



@bot.message_handler(commands=['start'])
def start(message):

    markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
    btn1 = types.KeyboardButton("üëã –ü–æ–∑–¥–æ—Ä–æ–≤–∞—Ç—å—Å—è")
    markup.add(btn1)
    bot.send_message(message.from_user.id, "üëã –ü—Ä–∏–≤–µ—Ç! –Ø —Ç–≤–æ–π –±–æ—Ç-–ø–æ–º–æ—à–Ω–∏–∫ –†–æ—Å–∞—Ç–æ–º!", reply_markup=markup)
    if message.text == 'üëã –ü–æ–∑–¥–æ—Ä–æ–≤–∞—Ç—å—Å—è':
        bot.send_message(message.from_user.id, '‚ùì –ó–∞–¥–∞–π—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–π –≤–∞—Å –≤–æ–ø—Ä–æ—Å', reply_markup=types.ReplyKeyboardRemove()) #–æ—Ç–≤–µ—Ç –±–æ—Ç–∞

@bot.message_handler(content_types=['text'])
def get_text_messages(message):

    text = message.text
    messages.append(HumanMessage(content=text))
    res = chat(messages)
    messages.append(res)
    print(res.content)
    bot.send_message(message.chat.id, res.content)

bot.polling(none_stop=True, interval=0) #–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –¥–ª—è —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞ —á–∞—Å—Ç—å
